/*!
  * assets-realod v1.0.0
  * (c) 2019 wilsonliuxyz@gmail.com
  * desc switch all assets cdn name (script,link,background-image,img). when you open one website in a test domain you can switch cdn name to location.hostname
  * @license MIT
  */
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):e.assetsRealod=r()}(this,function(){"use strict";function e(e){this.replaceFunc=e,this.switchCache={SCRIPT:[],IMAGE:[],LINK:[],BACKGROUNDIMAGE:[]}}return e.prototype={reset:function(){try{this.relaceScriptSrc(),this.replaceLinkStyle(),this.replaceBackGroundImage(),this.relaceImgSrc(),this.hackWebpack()}catch(e){console.error(e)}},extendAttr:function(e,r){var t={},n={crossorigin:"crossOrigin"};for(var c in e.attributes)if(e.attributes.hasOwnProperty(c)){var a=e.attributes[c],i=n[a.name]||a.name;t[i]=a.value,-1!=["onerror","onload","onabort"].indexOf(i)?r[i]=e[i]:r[a.name]=a.value}return this.switchCache[e.nodeName].push(t),t},relaceScriptSrc:function(){var e=document.querySelectorAll("script");if(0==e.length)return!1;for(var r=0;r<e.length;r++){var t=e[r];this.replaceOneScript(t)}},replaceLinkStyle:function(){var e=document.querySelectorAll("link");if(0==e.length)return!1;for(var r=0;r<e.length;r++){var t=e[r],n=this;this.replaceOneLink(t,function(){n.replaceBackGroundImage()})}},replaceOneScript:function(e){var r=e.src,t=this.replaceFunc(r,"script",e);if(t){var n=document.createElement("script");this.extendAttr(e,n),n.src=t,e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)}},replaceOneLink:function(e,r){var t=this.replaceFunc(e.href,"link",e);if(t){var n=document.createElement("link");this.extendAttr(e,n),n.href=t,r&&(n.onload?n.onload=function(){r(),n.onload(arguments)}:n.onload=r),e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)}},replaceBackGroundImage:function(){if(!document.styleSheets||!document.styleSheets[0])return!1;for(var e=document.styleSheets.length,r=0;r<e;r++){var t=document.styleSheets[r];try{if(!(t.rules&&0<t.rules.length))continue;for(var n=0;n<t.rules.length;n++){var c=t.rules[n],a=c.selectorText&&c.style&&c.style.backgroundImage;if(a){var i=this.replaceFunc(a,"backgroundImage",c);if(i){var o=c.selectorText+"{ background-image:"+i+"}",s=r+o;-1!=this.switchCache.BACKGROUNDIMAGE.indexOf(s)&&(this.switchCache.BACKGROUNDIMAGE.push(s),t.insertRule(o,t.rules.length))}}}}catch(e){}}},relaceImgSrc:function(){for(var e=document.querySelectorAll("img"),r=0;r<e.length;r++){var t=e[r],n=this.replaceFunc(t.src,"imgage",t);n&&(this.switchCache.IMAGE.push(t.src),t.src=n)}},replaceWebpackPublicUrl:function(e){if(!e||!e.p)return!1;window.__webpack_require__=e;var r=this.replaceFunc(__webpack_require__.p,"webpack",e);r&&(__webpack_require__.p=r)},hackWebpack:function(e){var c=this,r=[e=e||"cdnAssetsSwitchWebpack"],t={};t[e]=function(e,r,t){if(t){window.__webpack_require__=t;var n=c.replaceFunc(t.p,"webpack",t);n&&(t.p=n)}};var n=[[e]];(window.webpackJsonp=window.webpackJsonp||[]).push([r,t,n])}},e});