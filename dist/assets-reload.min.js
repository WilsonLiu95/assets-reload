/*!
  * assets-reload v1.1.0
  * (c) 2019 wilsonliuxyz@gmail.com
  * @description switch all assets cdn name (script,link,background-image,img). when you open one website in a test domain you can switch cdn name to location.hostname
  * @license MIT
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.AssetsReload=t()}(this,function(){"use strict";var e=function(e,t){this.replaceFunc=e,this.beforeInsertHook=t||function(){},this.reloadCache={SCRIPT:[],IMG:[],LINK:[],BACKGROUNDIMAGE:[]},this.mapConf={SCRIPT:{linkKey:"src"},IMG:{linkKey:"src"},LINK:{linkKey:"href"}}};return e.prototype.reloadAll=function(e){var t=document.getElementsByTagName(e),r=t.length;if(0===r)return!1;for(var n=0;n<r;n++)this.reload(t[n])},e.prototype.reload=function(e){var t=e.nodeName,r=this.mapConf[t].linkKey,n=e[r],o=this.replaceFunc(n,e);if(!o)return!1;var a=document.createElement(t);this.extendAttr(e,a),a[r]=o,this.beforeInsertHook(t,e,a),this.reloadCache[t].push(n),e.parentNode.insertBefore(a,e),e.parentNode.removeChild(e)},e.prototype.reloadBackgroundImage=function(){if(!(document.styleSheets&&document.styleSheets[0]))return!1;for(var e=document.styleSheets.length,t=0;t<e;t++){var r=document.styleSheets[t];try{if(!(r.rules&&0<r.rules.length))continue;for(var n=0;n<r.rules.length;n++){var o=r.rules[n],a=o.selectorText&&o.style&&o.style.backgroundImage;if(a){var s=a.match(/url\(["|'](.*)["|']\)/),i=s&&s[1];if(i&&-1===i.indexOf("data:image/")){var l="BACKGROUNDIMAGE",u=this.replaceFunc(i,o);if(u){var c=o.selectorText+"{ background-image: url("+u+")}",d=t+c;-1===this.reloadCache[l].indexOf(d)&&(this.beforeInsertHook(l,i,u),this.reloadCache[l].push(d),r.insertRule(c,r.rules.length))}}}}}catch(e){console.log("CdnAssetsSwitch replaceBackGroundImage",e)}}},e.prototype.extendAttr=function(e,t){var r={crossorigin:"crossOrigin"};if(e&&e.attributes)for(var n in e.attributes)if(e.attributes.hasOwnProperty(n)){var o=e.attributes[n],a=r[o.name]||o.name;-1!==["onerror","onload","onabort"].indexOf(a)?t[a]=e[a]:t[o.name]=o.value}},e});