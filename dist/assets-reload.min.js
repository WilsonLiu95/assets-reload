/*!
  * assets-reload v1.0.0
  * (c) 2019 wilsonliuxyz@gmail.com
  * @description switch all assets cdn name (script,link,background-image,img). when you open one website in a test domain you can switch cdn name to location.hostname
  * @license MIT
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.AssetsReload=t()}(this,function(){"use strict";var e=function(e){this.replaceFunc=e,this.reloadCache={SCRIPT:[],IMG:[],LINK:[],BACKGROUNDIMAGE:[]},this.mapConf={SCRIPT:{linkKey:"src"},IMG:{linkKey:"src"},LINK:{linkKey:"href"}}};return e.prototype.reloadAll=function(e){var t=document.getElementsByTagName(e),r=t.length;if(0===r)return!1;for(var o=0;o<r;o++)this.reload(t[o])},e.prototype.reload=function(e){var t=e.nodeName,r=this.mapConf[t].linkKey,o=e[r],n=this.replaceFunc(o,t,e);if(!n)return!1;var a=document.createElement(t);this.extendAttr(e,a),a[r]=n,this.beforeInsertHook(t,e,a),this.reloadCache[t].push(o),e.parentNode.insertBefore(a,e),e.parentNode.removeChild(e)},e.prototype.reloadBackgroundImage=function(){if(!(document.styleSheets&&document.styleSheets[0]))return!1;for(var e=document.styleSheets.length,t=0;t<e;t++){var r=document.styleSheets[t];try{if(!(r.rules&&0<r.rules.length))continue;for(var o=0;o<r.rules.length;o++){var n=r.rules[o],a=n.selectorText&&n.style&&n.style.backgroundImage;if(a){var s=a.match(/url\(["|'](.*)["|']\)/),i=s&&s[1];if(i&&-1===i.indexOf("data:image/")){var c="BACKGROUNDIMAGE",l=this.replaceFunc(i,c,n);if(l){var u=n.selectorText+"{ background-image: url("+l+")}",d=t+u;-1===this.reloadCache[c].indexOf(d)&&(this.beforeInsertHook(c,i,l),this.reloadCache[c].push(d),r.insertRule(u,r.rules.length))}}}}}catch(e){console.log("CdnAssetsSwitch replaceBackGroundImage",e)}}},e.prototype.hackWebpack=function(o,e){var t;void 0===e&&(e="AssetsReloadMod");window.webpackJsonp=window.webpackJsonp||[],window.webpackJsonp.push([[e],(t={},t[e]=function(e,t,r){o&&o(r)},t),[[e]]])},e.prototype.extendAttr=function(e,t){var r={crossorigin:"crossOrigin"};if(e&&e.attributes)for(var o in e.attributes)if(e.attributes.hasOwnProperty(o)){var n=e.attributes[o],a=r[n.name]||n.name;-1!==["onerror","onload","onabort"].indexOf(a)?t[a]=e[a]:t[n.name]=n.value}},e});